{"version":3,"sources":["webpack:///./node_modules/@directus/extension-toolkit/mixins/layout.js","webpack:///./src/layouts/cards/layout.vue?f9f8","webpack:///./src/layouts/cards/layout.vue?04c6","webpack:///src/layouts/cards/layout.vue","webpack:///./src/layouts/cards/layout.vue?4928","webpack:///./src/layouts/cards/layout.vue"],"names":["module","exports","props","primaryKeyField","type","String","required","fields","Object","items","Array","default","viewOptions","viewQuery","loading","Boolean","lazyLoading","selection","link","sortField","collection","render","_vm","this","_h","$createElement","_c","_self","staticClass","on","onScroll","class","_l","item","index","key","id","attrs","emptySrc","icon","src","includes","length","$event","select","slot","title","interface","options","relation","subtitle","_e","$t","staticRenderFns","name","mixins","computed","content","methods","srcField","toLowerCase","privateHash","startsWith","data","url","delta","$emit","scrolled","scrollTop","newSelection","filter","component"],"mappings":"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","file":"js/chunk-05e79fc2.a4f96e5f.js","sourcesContent":["module.exports = {\n  props: {\n    primaryKeyField: {\n      type: String,\n      required: true\n    },\n    fields: {\n      type: Object,\n      required: true\n    },\n    items: {\n      type: Array,\n      default: () => ([])\n    },\n    viewOptions: {\n      type: Object,\n      default: () => ({})\n    },\n    viewQuery: {\n      type: Object,\n      default: () => ({})\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    lazyLoading: {\n      type: Boolean,\n      default: false\n    },\n    selection: {\n      type: Array,\n      default: () => []\n    },\n    link: {\n      type: String,\n      default: null\n    },\n    sortField: {\n      type: String,\n      default: null\n    },\n    collection: {\n      type: String,\n      default: null\n    }\n  }\n};\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layout.vue?vue&type=style&index=0&id=4edd1597&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layout.vue?vue&type=style&index=0&id=4edd1597&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"layout-cards\",on:{\"scroll\":_vm.onScroll}},[_c('div',{staticClass:\"cards\",class:{ loading: _vm.loading }},[_vm._l((_vm.items),function(item,index){return _c('v-card',{key:item.id,attrs:{\"to\":item[_vm.link],\"icon\":_vm.emptySrc(item) ? _vm.viewOptions.icon || 'photo' : null,\"opacity\":_vm.emptySrc(item) ? 'half' : null,\"src\":_vm.src(item),\"selected\":_vm.selection.includes(item.id),\"selection-mode\":_vm.selection.length > 0},on:{\"select\":function($event){return _vm.select(item.id)}}},[_c('template',{slot:\"title\"},[_c('v-ext-display',{key:(\"card-title-\" + (_vm.fields[_vm.title].interface) + \"-\" + index),attrs:{\"interface-type\":_vm.fields[_vm.title].interface,\"name\":_vm.title,\"collection\":_vm.collection,\"type\":_vm.fields[_vm.title].type,\"options\":_vm.fields[_vm.title].options,\"value\":item[_vm.title],\"relation\":_vm.fields[_vm.title].relation}})],1),(_vm.subtitle)?_c('template',{slot:\"subtitle\"},[_c('v-ext-display',{key:(\"card-subtitle-\" + (_vm.fields[_vm.subtitle].interface) + \"-\" + index),attrs:{\"interface-type\":_vm.fields[_vm.subtitle].interface,\"name\":_vm.subtitle,\"collection\":_vm.collection,\"type\":_vm.fields[_vm.subtitle].type,\"options\":_vm.fields[_vm.subtitle].options,\"value\":item[_vm.subtitle],\"relation\":_vm.fields[_vm.subtitle].relation}})],1):_vm._e()],2)}),(_vm.lazyLoading)?_c('v-card',{attrs:{\"icon\":\"hourglass_empty\",\"opacity\":\"half\",\"title\":_vm.$t('loading_more'),\"subtitle\":_vm.$t('one_moment')}}):_vm._e()],2),(_vm.loading)?_c('div',{staticClass:\"layout-loading\"},[_c('v-spinner')],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"layout-cards\" @scroll=\"onScroll\">\n    <div class=\"cards\" :class=\"{ loading: loading }\">\n      <v-card\n        v-for=\"(item, index) in items\"\n        :key=\"item.id\"\n        :to=\"item[link]\"\n        :icon=\"emptySrc(item) ? viewOptions.icon || 'photo' : null\"\n        :opacity=\"emptySrc(item) ? 'half' : null\"\n        :src=\"src(item)\"\n        :selected=\"selection.includes(item.id)\"\n        :selection-mode=\"selection.length > 0\"\n        @select=\"select(item.id)\"\n      >\n        <template slot=\"title\">\n          <v-ext-display\n            :key=\"`card-title-${fields[title].interface}-${index}`\"\n            :interface-type=\"fields[title].interface\"\n            :name=\"title\"\n            :collection=\"collection\"\n            :type=\"fields[title].type\"\n            :options=\"fields[title].options\"\n            :value=\"item[title]\"\n            :relation=\"fields[title].relation\"\n          />\n        </template>\n        <template v-if=\"subtitle\" slot=\"subtitle\">\n          <v-ext-display\n            :key=\"`card-subtitle-${fields[subtitle].interface}-${index}`\"\n            :interface-type=\"fields[subtitle].interface\"\n            :name=\"subtitle\"\n            :collection=\"collection\"\n            :type=\"fields[subtitle].type\"\n            :options=\"fields[subtitle].options\"\n            :value=\"item[subtitle]\"\n            :relation=\"fields[subtitle].relation\"\n          />\n        </template>\n      </v-card>\n      <v-card\n        v-if=\"lazyLoading\"\n        icon=\"hourglass_empty\"\n        opacity=\"half\"\n        :title=\"$t('loading_more')\"\n        :subtitle=\"$t('one_moment')\"\n      ></v-card>\n    </div>\n\n    <div v-if=\"loading\" class=\"layout-loading\">\n      <v-spinner />\n    </div>\n  </div>\n</template>\n\n<script>\nimport mixin from \"@directus/extension-toolkit/mixins/layout\";\nimport { mapState } from \"vuex\";\n\nexport default {\n  name: \"LayoutCards\",\n  mixins: [mixin],\n  computed: {\n    ...mapState([\"currentProjectKey\"]),\n    title() {\n      return this.viewOptions.title || this.primaryKeyField;\n    },\n    subtitle() {\n      return this.viewOptions.subtitle;\n    },\n    content() {\n      return this.viewOptions.content;\n    }\n  },\n  methods: {\n    src(item) {\n      const srcField = this.viewOptions.src || null;\n\n      if (srcField) {\n        let privateHash = null;\n\n        if (this.fields[srcField] && this.fields[srcField].type.toLowerCase() === \"file\") {\n          privateHash = item[srcField]?.private_hash;\n        }\n\n        if (srcField === \"data\" && this.fields[srcField].collection === \"directus_files\") {\n          if (item.type.startsWith(\"image\") === false) return null;\n\n          if (item.type === \"image/svg+xml\") {\n            return item.data.url;\n          }\n          privateHash = item?.private_hash;\n        }\n\n        if (!privateHash) return null;\n\n        const fit = this.viewOptions.fit || \"crop\";\n\n        return `/${this.currentProjectKey}/assets/${privateHash}?key=directus-medium-${fit}`;\n      }\n\n      return null;\n    },\n    emptySrc(item) {\n      return this.viewOptions.src != null && this.src(item) === null;\n    },\n    onScroll(event) {\n      const { scrollHeight, clientHeight, scrollTop } = event.srcElement;\n      const totalScroll = scrollHeight - clientHeight;\n      const delta = totalScroll - scrollTop;\n      if (delta <= 500) this.$emit(\"next-page\");\n      this.scrolled = scrollTop > 0;\n    },\n    select(id) {\n      let newSelection;\n\n      if (this.selection.includes(id)) {\n        newSelection = this.selection.filter(selectedID => selectedID !== id);\n      } else {\n        newSelection = [...this.selection, id];\n      }\n\n      this.$emit(\"select\", newSelection);\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.layout-cards {\n  overflow: auto;\n  height: 100%;\n  max-height: calc(100vh - var(--header-height-expanded));\n}\n\n.toolbar {\n  background-color: var(--page-background-color);\n  width: 100%;\n  position: sticky;\n  top: 0;\n  z-index: +1;\n  height: var(--header-height);\n  padding: 28px var(--page-padding);\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  border-bottom: 2px solid var(--sidebar-background-color);\n}\n\n.sort-select {\n  position: relative;\n  display: flex;\n  align-items: center;\n\n  margin: 0 10px;\n\n  &:last-of-type {\n    margin-right: 0;\n  }\n\n  select {\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    vertical-align: middle;\n    background-color: var(--input-background-color-alt);\n    border-radius: var(--border-radius);\n    border: 0;\n    overflow: hidden;\n    padding: 5px;\n    padding-right: 15px;\n    cursor: pointer;\n    outline: 0;\n  }\n\n  .icon {\n    pointer-events: none;\n    position: absolute;\n    right: 0;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n}\n\n.cards {\n  padding: var(--page-padding-top) var(--page-padding) var(--page-padding-bottom);\n  display: grid;\n  grid-template-columns: repeat(auto-fill, var(--card-size));\n  grid-gap: var(--card-vertical-gap) var(--card-horizontal-gap);\n  justify-content: space-between;\n  width: 100%;\n\n  &.loading {\n    opacity: 0.5;\n  }\n}\n\n.layout-loading {\n  padding: 24px 0;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layout.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./layout.vue?vue&type=template&id=4edd1597&scoped=true&\"\nimport script from \"./layout.vue?vue&type=script&lang=js&\"\nexport * from \"./layout.vue?vue&type=script&lang=js&\"\nimport style0 from \"./layout.vue?vue&type=style&index=0&id=4edd1597&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4edd1597\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}