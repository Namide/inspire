{"version":3,"sources":["webpack:///./src/helpers/get-fields-from-template.js","webpack:///./src/interfaces/repeater/input.vue?a098","webpack:///./src/interfaces/repeater/row.vue?8d8b","webpack:///src/interfaces/repeater/row.vue","webpack:///./src/interfaces/repeater/row.vue?c4f1","webpack:///./src/interfaces/repeater/row.vue","webpack:///src/interfaces/repeater/input.vue","webpack:///./src/interfaces/repeater/input.vue?739d","webpack:///./src/interfaces/repeater/input.vue","webpack:///./node_modules/core-js/modules/es6.regexp.match.js","webpack:///./src/interfaces/repeater/input.vue?3a10","webpack:///./node_modules/@directus/extension-toolkit/mixins/interface.js","webpack:///./src/interfaces/repeater/row.vue?2e8d"],"names":["getFieldsFromTemplate","string","regex","fields","match","map","field","replace","trim","render","_vm","this","_h","$createElement","_c","_self","staticClass","class","dragging","attrs","on","$event","endDrag","model","value","callback","$$v","rows","expression","_l","row","index","key","__key","repeaterFields","inline","options","template","open","placeholder","toggleOpen","updateRow","removeRow","addRow","_v","_s","createItemText","_e","staticRenderFns","ref","length","interface","required","readonly","type","datatype","$emit","showPlaceholder","displayValue","directives","name","rawName","props","Object","Array","Boolean","default","String","computed","preview","fieldsHaveValue","component","components","RepeaterRow","mixins","data","includes","width","every","addButtonVisible","limit","isArray","keys","created","setRows","methods","emitValue","newRow","newRows","splice","structure","_","keyBy","structure_key","getNewRow","forEach","JSON","parse","console","warn","values","anObject","toLength","advanceStringIndex","regExpExec","defined","MATCH","$match","maybeCallNative","regexp","O","fn","undefined","call","RegExp","res","done","rx","S","global","fullUnicode","unicode","lastIndex","result","A","n","matchStr","module","exports","id","Number","collection","newItem","relation","val"],"mappings":"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","file":"js/chunk-1740a5c2.20e1050d.js","sourcesContent":["/**\n * Extracts the fields from a template string\n * @param  {String} string Template string\n * @return {Array}         Field names\n * @example\n *\n * getFieldsFromTemplate(\"{{ title }} — {{ runtime }}\");\n * // -> [\"title\", \"runtime\"]\n */\nexport default function getFieldsFromTemplate(string) {\n  const regex = /{{(.*?)}}/g;\n  let fields = string.match(regex);\n  fields = fields.map(field => {\n    return field\n      .replace(/{{/g, \"\")\n      .replace(/}}/g, \"\")\n      .trim();\n  });\n  return fields;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"interface-repeater\"},[_c('draggable',{staticClass:\"row-container\",class:{ dragging: _vm.dragging },attrs:{\"handle\":\".drag-handle\"},on:{\"start\":function($event){_vm.dragging = true},\"end\":_vm.endDrag},model:{value:(_vm.rows),callback:function ($$v) {_vm.rows=$$v},expression:\"rows\"}},_vm._l((_vm.rows),function(row,index){return _c('repeater-row',{key:row.__key,attrs:{\"row\":row,\"fields\":_vm.repeaterFields,\"inline\":_vm.inline,\"template\":_vm.options.template,\"open\":_vm.open === index,\"placeholder\":_vm.options.placeholder},on:{\"open\":function($event){return _vm.toggleOpen(index)},\"input\":function($event){return _vm.updateRow(index, $event)},\"remove\":function($event){return _vm.removeRow(index)}}})}),1),(_vm.addButtonVisible)?_c('div',{staticClass:\"add-new\",on:{\"click\":_vm.addRow}},[_c('v-icon',{attrs:{\"name\":\"add\",\"color\":\"input-icon-color\"}}),_vm._v(\"\\n    \"+_vm._s(_vm.options.createItemText)+\"\\n  \")],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-sheet',{ref:\"interfaceRoot\",staticClass:\"repeater-row\"},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"drag-handle\"},[_c('v-icon',{attrs:{\"name\":\"drag_handle\"}})],1),_c('div',{staticClass:\"content\",class:{ 'two-up': _vm.inline && _vm.fields.length === 2 }},[(_vm.inline)?_vm._l((_vm.fields),function(field){return _c('v-ext-input',{key:field.field,attrs:{\"id\":field.interface || 'text-input',\"name\":field.field,\"required\":field.required,\"readonly\":field.readonly,\"options\":field.options,\"type\":field.type,\"datatype\":field.datatype,\"value\":_vm.row[field.field],\"fields\":_vm.fields,\"values\":_vm.row,\"length\":field.length},on:{\"input\":function($event){return _vm.$emit('input', {\n              field: field.field,\n              value: $event\n            })}}})}):_c('button',{class:_vm.showPlaceholder ? 'placeholder' : 'preview',attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$emit('open')}}},[_vm._v(\"\\n        \"+_vm._s(_vm.showPlaceholder ? _vm.placeholder : _vm.displayValue)+\"\\n      \")])],2),_c('button',{attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.$emit('remove')}}},[_c('v-icon',{staticClass:\"remove\",attrs:{\"name\":\"delete_outline\"}})],1)]),(_vm.inline === false)?_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.open),expression:\"open\"}],staticClass:\"body\"},[_c('v-form',{attrs:{\"full-width\":\"\",\"fields\":_vm.fields,\"values\":_vm.row},on:{\"stage-value\":function($event){return _vm.$emit('input', $event)}}})],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-sheet ref=\"interfaceRoot\" class=\"repeater-row\">\n    <div class=\"header\">\n      <div class=\"drag-handle\">\n        <v-icon name=\"drag_handle\" />\n      </div>\n      <div class=\"content\" :class=\"{ 'two-up': inline && fields.length === 2 }\">\n        <template v-if=\"inline\">\n          <v-ext-input\n            v-for=\"field in fields\"\n            :id=\"field.interface || 'text-input'\"\n            :key=\"field.field\"\n            :name=\"field.field\"\n            :required=\"field.required\"\n            :readonly=\"field.readonly\"\n            :options=\"field.options\"\n            :type=\"field.type\"\n            :datatype=\"field.datatype\"\n            :value=\"row[field.field]\"\n            :fields=\"fields\"\n            :values=\"row\"\n            :length=\"field.length\"\n            @input=\"\n              $emit('input', {\n                field: field.field,\n                value: $event\n              })\n            \"\n          />\n        </template>\n        <button\n          v-else\n          type=\"button\"\n          :class=\"showPlaceholder ? 'placeholder' : 'preview'\"\n          @click=\"$emit('open')\"\n        >\n          {{ showPlaceholder ? placeholder : displayValue }}\n        </button>\n      </div>\n      <button type=\"button\" @click=\"$emit('remove')\">\n        <v-icon name=\"delete_outline\" class=\"remove\" />\n      </button>\n    </div>\n    <div v-if=\"inline === false\" v-show=\"open\" class=\"body\">\n      <v-form full-width :fields=\"fields\" :values=\"row\" @stage-value=\"$emit('input', $event)\" />\n    </div>\n  </v-sheet>\n</template>\n\n<script>\nimport getFieldsFromTemplate from \"@/helpers/get-fields-from-template\";\n\nexport default {\n  name: \"RepeaterRow\",\n  props: {\n    row: {\n      type: Object,\n      required: true\n    },\n    fields: {\n      type: Array,\n      required: true\n    },\n    inline: {\n      type: Boolean,\n      default: false\n    },\n    template: {\n      type: String,\n      default: null\n    },\n    open: {\n      type: Boolean,\n      default: false\n    },\n    placeholder: {\n      type: String,\n      required: true\n    }\n  },\n  computed: {\n    displayValue() {\n      if (!this.template) {\n        return this.row[this.fields[0].field];\n      }\n\n      let preview = this.$helpers.micromustache.render(this.template, this.row);\n\n      return preview;\n    },\n    showPlaceholder() {\n      let fields = [this.fields[0].field];\n\n      if (this.template) {\n        fields = getFieldsFromTemplate(this.template);\n      }\n\n      const fieldsHaveValue = fields.every(field => {\n        return this.row[field] !== null && this.row[field]?.length > 0;\n      });\n\n      return fieldsHaveValue === false;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.repeater-row {\n  margin-bottom: 8px;\n  padding: 0;\n}\n\n.header {\n  --form-vertical-gap: 24px;\n  --form-horizontal-gap: 12px;\n  --type-label-size: 15px;\n  --input-height: 44px;\n  --input-font-size: 14px;\n  --input-label-margin: 4px;\n  --input-background-color-alt: var(--input-background-color);\n\n  display: flex;\n  align-items: center;\n  min-height: var(--input-height);\n  padding: var(--input-padding);\n\n  .drag-handle {\n    color: var(--input-icon-color);\n    cursor: grab;\n  }\n\n  .content {\n    flex-grow: 1;\n    display: grid;\n    grid-template-columns: repeat(1, 1fr);\n    grid-gap: 8px;\n    padding: 0 8px;\n\n    &.two-up {\n      grid-template-columns: repeat(2, 1fr);\n    }\n\n    .placeholder {\n      color: var(--input-placeholder-color);\n      font-style: italic;\n    }\n\n    .preview,\n    .placeholder {\n      text-align: left;\n      min-height: 32px;\n    }\n  }\n\n  .remove {\n    transition: color var(--fast) var(--transition);\n    color: var(--input-icon-color);\n    &:hover {\n      color: var(--danger);\n    }\n  }\n}\n\n.body {\n  --form-vertical-gap: 24px;\n  --form-horizontal-gap: 12px;\n  --type-label-size: 15px;\n  --input-height: 44px;\n  --input-font-size: 14px;\n  --input-label-margin: 4px;\n  --input-background-color-alt: var(--input-background-color);\n  padding: 8px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./row.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./row.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./row.vue?vue&type=template&id=20df98ff&scoped=true&\"\nimport script from \"./row.vue?vue&type=script&lang=js&\"\nexport * from \"./row.vue?vue&type=script&lang=js&\"\nimport style0 from \"./row.vue?vue&type=style&index=0&id=20df98ff&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"20df98ff\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"interface-repeater\">\n    <draggable\n      v-model=\"rows\"\n      handle=\".drag-handle\"\n      class=\"row-container\"\n      :class=\"{ dragging }\"\n      @start=\"dragging = true\"\n      @end=\"endDrag\"\n    >\n      <repeater-row\n        v-for=\"(row, index) in rows\"\n        :key=\"row.__key\"\n        :row=\"row\"\n        :fields=\"repeaterFields\"\n        :inline=\"inline\"\n        :template=\"options.template\"\n        :open=\"open === index\"\n        :placeholder=\"options.placeholder\"\n        @open=\"toggleOpen(index)\"\n        @input=\"updateRow(index, $event)\"\n        @remove=\"removeRow(index)\"\n      />\n    </draggable>\n    <div v-if=\"addButtonVisible\" class=\"add-new\" @click=\"addRow\">\n      <v-icon name=\"add\" color=\"input-icon-color\" />\n      {{ options.createItemText }}\n    </div>\n  </div>\n</template>\n\n<script>\nimport mixin from \"@directus/extension-toolkit/mixins/interface\";\nimport RepeaterRow from \"./row\";\nimport shortid from \"shortid\";\n\nexport default {\n  name: \"Repeater\",\n  components: {\n    RepeaterRow\n  },\n  mixins: [mixin],\n  data() {\n    return {\n      rows: [],\n      dragging: false,\n      open: null\n    };\n  },\n  computed: {\n    // If the interface is able to display the fields inline\n    inline() {\n      // Only render inline when there are 1 or two fields\n      if (this.repeaterFields.length > 2) {\n        return false;\n      }\n\n      // If there's only 1 field, render it regardless of size\n      if (this.repeaterFields.length === 1) {\n        return true;\n      }\n\n      // Only render inline if there's enough space in the parent\n      // We want to prevent the two interfaces being squashed togt\n      if ([\"full\", \"fill\"].includes(this.width) === false) {\n        return false;\n      }\n\n      // Only render inline if every field is configured to be half width\n      return this.repeaterFields.every(field => field.width === \"half\");\n    },\n    addButtonVisible() {\n      if (!this.options.limit || this.options.limit === 0) return true;\n      if (this.rows.length < this.options.limit) return true;\n\n      return false;\n    },\n\n    // This makes sure that the fields are always an array of fields. It makes sure the interface\n    // is backwards compatible for people who have their repeater setup in an object structure\n    repeaterFields() {\n      if (Array.isArray(this.options.fields)) {\n        return this.options.fields;\n      }\n\n      return Object.keys(this.options.fields).map(key => {\n        return {\n          ...this.options.fields[key],\n          field: key\n        };\n      });\n    }\n  },\n  created() {\n    this.setRows();\n  },\n  methods: {\n    addRow() {\n      this.rows = [...this.rows, this.getNewRow()];\n      this.open = this.rows.length - 1;\n      this.emitValue();\n    },\n    updateRow(index, { field, value }) {\n      const rows = _.clone(this.rows);\n      const currentRow = rows[index];\n      const newRow = {\n        ...currentRow,\n        [field]: value\n      };\n\n      rows[index] = newRow;\n\n      this.rows = rows;\n      this.emitValue();\n    },\n    removeRow(index) {\n      const newRows = _.clone(this.rows);\n      newRows.splice(index, 1);\n      this.rows = newRows;\n      this.emitValue();\n    },\n\n    emitValue() {\n      let value = _.clone(this.rows).map(row => {\n        delete row.__key;\n        return row;\n      });\n\n      if (value.length === 0) {\n        return this.$emit(\"input\", null);\n      }\n\n      if (this.options.structure === \"object\") {\n        this.$emit(\"input\", _.keyBy(value, this.options.structure_key));\n      } else {\n        this.$emit(\"input\", value);\n      }\n    },\n    getNewRow() {\n      const row = {\n        __key: shortid.generate()\n      };\n\n      this.repeaterFields.forEach(field => {\n        row[field.field] = field.default;\n      });\n\n      return row;\n    },\n    // There's two different structures in which the interface value can be saved\n    // This method makes sure we're always using the same structure in the interface itself\n    setRows() {\n      if (this.value === null) {\n        this.rows = [];\n        return;\n      }\n\n      if (Array.isArray(this.value)) {\n        this.rows = this.value;\n      } else if (typeof this.value === \"string\") {\n        try {\n          this.rows = JSON.parse(this.value);\n        } catch {\n          console.warn(\"Invalid JSON passed to repeater\");\n        }\n      } else {\n        this.rows = Object.values(this.value);\n      }\n    },\n    endDrag() {\n      this.dragging = false;\n      this.emitValue();\n    },\n    toggleOpen(index) {\n      if (this.open === index) {\n        this.open = null;\n      } else {\n        this.open = index;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.notice {\n  margin-bottom: 12px;\n}\n\n.add-new {\n  display: flex;\n  align-items: center;\n  padding: var(--input-padding);\n  border: var(--input-border-width) dotted var(--input-border-color);\n  border-radius: var(--border-radius);\n  color: var(--input-text-color);\n  transition: var(--fast) var(--transition);\n  transition-property: color, border-color, padding;\n  min-height: var(--input-height);\n  font-size: var(--input-font-size);\n  padding: var(--input-padding);\n  cursor: pointer;\n  &:hover {\n    border-color: var(--input-border-color-hover);\n  }\n  i {\n    margin-right: 8px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./input.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./input.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./input.vue?vue&type=template&id=54b6fafc&scoped=true&\"\nimport script from \"./input.vue?vue&type=script&lang=js&\"\nexport * from \"./input.vue?vue&type=script&lang=js&\"\nimport style0 from \"./input.vue?vue&type=style&index=0&id=54b6fafc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"54b6fafc\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\n\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@match logic\nrequire('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[MATCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative($match, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      if (!rx.global) return regExpExec(rx, S);\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./input.vue?vue&type=style&index=0&id=54b6fafc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./input.vue?vue&type=style&index=0&id=54b6fafc&lang=scss&scoped=true&\"","module.exports = {\n  props: {\n    // Unique id for this interface. Should be added to the lower level \n    // HTML input element if applicable. This ID will be used in the label's\n    // `for` attribute\n    id: {\n      type: String,\n      required: true\n    },\n    // Name of the field\n    name: {\n      type: String,\n      required: true\n    },\n    // The current value. This can either be the default value, the saved database\n    // value or the current state after the user made an edit\n    value: {\n      type: null,\n      default: null\n    },\n    // Type of the field, eg `string`, `hash`, or `array`\n    type: {\n      type: String,\n      required: true\n    },\n    // Max length\n    length: {\n      type: [String, Number],\n      default: null\n    },\n    // If the field is readonly or not\n    readonly: {\n      type: Boolean,\n      default: false\n    },\n    // Name of the collection\n    collection: {\n      type: String,\n      default: null\n    },\n    // If the field is required or not\n    required: {\n      type: Boolean,\n      default: false\n    },\n    // Field options. A json object based on the interface's meta.json file\n    options: {\n      type: Object,\n      default: () => ({})\n    },\n    // If the item that's currently being edited is new\n    newItem: {\n      type: Boolean,\n      default: false\n    },\n    // The relation of the current field. Will contain information on the related\n    // collection and field(s)\n    relation: {\n      type: Object,\n      default: null\n    },\n    // The other fields in the current edit page\n    fields: {\n      type: Object,\n      default: null\n    },\n    // The values of the other fields on the edit page. Can be used for things like\n    // automatically generating a slug based on another field\n    values: {\n      type: Object,\n      default: null\n    },\n    width: {\n      type: String,\n      default: null,\n      validator(val) {\n        return [\n          'half',\n          'half-left',\n          'half-right',\n          'full',\n          'fill'\n        ].includes(val);\n      }\n    }\n  }\n};\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./row.vue?vue&type=style&index=0&id=20df98ff&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./row.vue?vue&type=style&index=0&id=20df98ff&lang=scss&scoped=true&\""],"sourceRoot":""}